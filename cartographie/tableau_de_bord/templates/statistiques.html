{% extends "base_tableau_de_bord.html" %}
{% load statusLabel %}

{% block Contenu %}
    <div class="span12">
        <div class="content">
            <h2 class="pull-left">
                Tableau de bord - Statistiques
            </h2>
            <h5 class="pull-right">Bienvenue {{ request.user.username }}</h5>
            <div class="clear"></div>

            {% include "dashboard_liste_onglets.html" %}

            {% include "msg_user_sans_region.html" %}

            <h3>Nombre de formation total: {{ total_nb_formations }}</h3>

            {% if not user_sans_region %}
            <h4>Nombre de formation dans les établissements sous votre gestion: {{ total_nb_formations_sous_gestion }}</h4>
            {% endif %}

            <h3>Par régions</h3>
            <table class="table table-striped table-bordered table-hover table-condensed">
                <thead>
                    <tr>
                        <th>Région</th>
                        <th class="span2">Quantité</th>
                    </tr>
                </thead>
                <tbody>
                    {% for stat in totaux_par_regions %}
                    <tr>
                        <td>{{ stat.etablissement__region__nom }}</td>
                        <td>{{ stat.total }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>

            <h3>Par pays</h3>
            <table class="table table-striped table-bordered table-hover table-condensed">
                <thead>
                    <tr>
                        <th>Pays</th>
                        <th class="span2">Quantité</th>
                    </tr>
                </thead>
                {% for stat in totaux_par_pays %}
                <tr>
                    <td>{{ stat.etablissement__pays__nom }}</td>
                    <td>{{ stat.total }}</td>
                </tr>
                {% endfor %}
            </table>

            <h3>Par statut</h3>
            <table class="table table-striped table-bordered table-hover table-condensed">
                <thead>
                    <tr>
                        <th>Statut</th>
                        <th class="span2">Quantité</th>
                    </tr>
                </thead>
                {% for stat in totaux_par_statut %}
                <tr>
                    <td>{{ stat.statut|statusLabel }}</td>
                    <td>{{ stat.total }}</td>
                </tr>
                {% endfor %}
            </table>

            <h3>Par établissement sous votre gestion</h3>
            <table class="table table-striped table-bordered table-hover table-condensed">
                <thead>
                    <tr>
                        <th>Établissement</th>
                        <th class="span2">Quantité</th>
                    </tr>
                </thead>
                {% for stat in totaux_par_etablissements %}
                <tr>
                    <td>{{ stat.etablissement__nom }}</td>
                    <td>{{ stat.total }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>
{% endblock %}