{% load statusLabel %}

{% include "cartographie/messages.html" %}

<form id="select-form" method="POST" action="{% url formation_select_actualiser token etablissement_id %}">
  {% csrf_token %}
  <h4 class="pull-left">Liste des formations</h4>
  <div class="actions pull-right">
    <a href="{% url formation_ajouter token %}" class="btn btn-info">
      <i class="icon icon-plus icon-white"></i>
      Ajouter une formation
    </a>

    {% if formations and peut_actualiser %}
    <a href="{% url formation_tout_actualiser token etablissement_id %}" class="btn">
      <i class="icon icon-repeat"></i> Tout actualiser
    </a>

    <a id="select-update" href="javascript:void(0);" class="btn disabled">
      <i class="icon icon-repeat"></i> Actualiser la sélection
    </a>
    {% endif %}
  </div>

  <div class="clear"></div>

  {% if formations %}
  <table class="table table-striped table-bordered table-hover table-condensed">
    <thead>
      <tr>
        {% if peut_actualiser %}<th></th>{% endif %}
        <th>Formation</th>
        <th>Statut</th>
        <th>Date de modification</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
    {% for f in formations %}
    {% if f|expired %}
    <tr class="expired">
    {% else %}
    <tr>
    {% endif %}
      {% if peut_actualiser %}
      <td>
        <input type="checkbox" name="formation-{{ f.id }}" class="select-check" />
      </td>
      {% endif %}

      <td>
        <p><a href="{% url formation_consulter token f.id %}">
          {{ f.nom }}
        </a></p>
      </td>

      <td>
        {{ f.statut|statusLabel }}
      </td>

      <td>
        {{ f.date_modification }}
      </td>

      <td>
        <a class="btn" href="{% url formation_consulter token f.id %}"><i class="icon icon-search"></i> Consulter</a>
        <a class="btn" href="{% url formation_modifier token f.id %}"><i class="icon icon-pencil"></i> Modifier</a>
        <a class="btn" href="{% url formation_historique token f.id %}"><i class="icon icon-eye-open"></i> Historique</a>
        {% if peut_actualiser %}<a class="btn" href="{% url formation_actualiser token f.id %}"><i class="icon icon-repeat"></i> Actualiser</a>{% endif %}
      </td>
    </tr>
    {% endfor %}
    </tbody>
  </table>
  {% else %}
  <div class="alert alert-info">
    Aucune formation n'existe encore dans le système pour votre établissement.<br />
    Cliquez sur le bouton <b class="text-info">Ajouter une formation</b> pour commencer la saisie.
  </div>
  {% endif %}
</form>
